# Banking service

Данная система предоставляет функции для управления счетами банковских клиентов.

## Возможности

Система предоставляется следующие функции:

- Взаимодействие с клиентами через REST API сервиса accounts или через веб-интерфейс сервиса web-ui в браузере.
- Создание аккаунтов клиентов.
- Создание и просмотр счетов у клиента для определенной валюты.
- Пополнение и списание денег со счета.
- Перевод средств между счетами одного клиента и между счетами клиентов с конвертацией валюты.

## Архитектура

Данная система имеет микросервисную архитектуру и состоит из следующих сервисов:

- Сервис __accounts__ выполняет запросы по обработке счетов и аккаунтов клиентов (создание аккаунта и счетов,
  получение баланса аккаунта и счета, пополнение счетов, снятие денег, перевод средств между счетами).
- Сервис __converter__ выполняет конвертацию валюты по запросам от _accounts_, которые осуществляются по gRPC или REST
  (зависит от настроек клиента).
- Сервис __rates__ выдает актуальный курс валют для _converter_ по gRPC.
- Сервис __keycloak__ авторизует запросы от _converter_ к _rates_.
- Сервис __transactions__ получает сообщения об операциях со счетами от _Kafka_ и сохраняет информацию в _MongoDB_.
- __RDBMS__ (Postgresql) хранит данные о клиентах.
- __Redis__ выполняет функцию поддержания идемпотентности запросов изменения счетов клиентов.
- __MongoDB__ хранит информацию о совершенных операциях со счетами клиентов (перевод, пополнение, списание средств).
- __Kafka__ содержит топик с сообщениями о совершенных операциях со счетами клиентов.
- Сервис __web-ui__ предоставляет графический интерфейс к системе через браузер.

![Components structure](docs/pics/components-structure.drawio.png)

API сервисов описан в формате OpenAPI и gRPC (для сервиса converter), спецификация находится в папке [api](./api). 

## Запуск

Запустить систему на локальном компьютере можно через docker compose, предварительно собрав проект.

```
cd "$BANKING_ROOT_DIR"
mvn clean install

cd "$BANKING_ROOT_DIR/test/docker"
bash cp-build.sh
docker compose up -d
```

Затем можно добавить начальные данные через скрипт.

```
cd "$BANKING_ROOT_DIR"
python3 test/initial-requests.py
```

Взаимодействовать с системой можно через браузер, открыв страницу http://localhost:8085/customers.
