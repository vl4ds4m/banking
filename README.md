# Banking service

Данная система предоставляет функции для управления счетами банковских клиентов.

## Возможности

Система предоставляется следующие функции:

- Взаимодействие клиентов и администратора через веб-интерфейс сервиса web-ui в браузере
(или через REST API сервиса accounts с правами администратора).
- Создание аккаунтов клиентов.
- Создание и просмотр счетов у клиента для определенной валюты.
- Пополнение и списание денег со счета.
- Перевод средств между счетами одного клиента и между счетами клиентов с конвертацией валюты.

## Архитектура

Данная система имеет микросервисную архитектуру и состоит из следующих сервисов:

- Сервис __web-ui__ предоставляет графический интерфейс к системе через браузер.
- Сервис __accounts__ выполняет запросы по обработке счетов и аккаунтов клиентов (создание аккаунта и счетов,
  получение баланса аккаунта и счета, пополнение счетов, снятие денег, перевод средств между счетами).
- Сервис __converter__ выполняет конвертацию валюты по запросам от _accounts_, которые осуществляются по gRPC или REST
  (зависит от настроек клиента).
- Сервис __rates__ выдает актуальный курс валют для _converter_ по gRPC.
- Сервис __keycloak__ авторизует запросы между сервисами и аутентифицирует пользователей через web-интерфейс web-ui.
- Сервис __transactions__ получает сообщения об операциях со счетами от _Kafka_ и сохраняет информацию в _MongoDB_.
- __RDBMS__ (Postgresql) хранит данные о клиентах.
- __Redis__ выполняет функцию поддержания идемпотентности запросов изменения счетов клиентов.
- __MongoDB__ хранит информацию о совершенных операциях со счетами клиентов (перевод, пополнение, списание средств).
- __Kafka__ содержит топик с сообщениями о совершенных операциях со счетами клиентов.

![Components structure](docs/pics/components-structure.svg)

API внутренних сервисов (_accounts_, _converter_, _rates_) описан в формате OpenAPI и gRPC (для сервиса converter),
спецификация находится в папке [api](./api). 

## Запуск

Запустить систему на локальном компьютере можно через docker compose, предварительно собрав проект.

```
mvn clean install

cd test/docker
docker compose up -d
```

NOTE: для сервисов пока не настроены healthcheck'и, поэтому может понадобиться перезапуск упавших сервисов.

Затем необходимо добавить в файл __hosts__ запись `127.0.0.1 banking.local` и перейти на http://banking.local/.

### Зарегистрированные пользователи

- Клиенты: _ivanovp_, _jsmithy_, _tt_goat_ (у всех пароль _1234_)
- Администратор: _plodg_ (пароль _pl0d6_)
